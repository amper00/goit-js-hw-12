{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import './css/styles.css'; \nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from 'axios';\n\nlet page = 1;\nconst perPage = 40;\nlet currentQuery = '';\nlet totalHits = 0;\nlet totalPages = 0;\n\ndocument.getElementById('search-form').addEventListener('submit', async event => {\n    event.preventDefault();\n    const query = document.getElementById('search-query').value;\n    if (query !== currentQuery) {\n        currentQuery = query;\n        page = 1;\n        totalHits = 0;\n        totalPages = 0;\n        document.querySelector('.gallery').innerHTML = ''; \n        hideLoadMoreButton(); \n    }\n    await fetchImages(query);\n});\n\ndocument.getElementById('load-more').addEventListener('click', async () => {\n    await fetchImages(currentQuery);\n});\n\nasync function fetchImages(query) {\n    const loader = document.querySelector('.loader');\n    const loadMoreButton = document.getElementById('load-more');\n    \n    loader.classList.remove('hidden');\n    loader.style.display = 'block';\n    loadMoreButton.classList.add('hidden');\n\n    const apiKey = '44974018-ca766bb5bf44f97c206908e6f'; \n    const url = `https://pixabay.com/api/?key=${apiKey}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`;\n\n    try {\n        const response = await axios.get(url);\n        loader.classList.add('hidden');\n        loader.style.display = 'none';\n\n        totalHits = response.data.totalHits;\n        totalPages = Math.ceil(totalHits / perPage);\n\n        if (response.data.hits.length === 0 && page === 1) {\n            iziToast.error({\n                title: 'Error',\n                message: 'Przepraszamy, nie ma obraz√≥w zgodnych z wyszukiwaniem. Spr√≥buj ponownie!'\n            });\n        } else {\n            displayImages(response.data.hits);\n            page++; \n            if (page > totalPages) {\n                iziToast.error({\n                    position: \"topRight\",\n                    message: \"We're sorry, there are no more posts to load\"\n                });\n                hideLoadMoreButton();\n            } else {\n              \n                showLoadMoreButton(); \n                   scrollPage();\n                \n\n            }\n        }\n    } catch (error) {\n        loader.classList.add('hidden');\n        loader.style.display = 'none';\n        iziToast.error({\n            title: 'Error',\n            message: `There was a problem with the fetch operation: ${error}`\n        });\n        console.log(error);\n    }\n}\n\nfunction displayImages(images) {\n    const gallery = document.querySelector('.gallery');\n\n    const items = images.map(image => {\n        const li = document.createElement(\"li\");\n        li.classList.add(\"gallery-item\");\n\n        const a = document.createElement(\"a\");\n        a.classList.add(\"gallery-link\");\n        a.href = image.largeImageURL;\n        a.setAttribute('data-lightbox', 'gallery');\n        a.setAttribute('data-title', `‚ù§Ô∏è ${image.likes} üëÅÔ∏è ${image.views} üí¨ ${image.comments} ‚¨áÔ∏è ${image.downloads}`);\n\n        const img = document.createElement(\"img\");\n        img.classList.add(\"gallery-image\");\n        img.src = image.webformatURL;\n        img.alt = image.tags;\n\n        const underDiv = document.createElement(\"div\");\n        underDiv.classList.add(\"image-info\");\n        underDiv.innerHTML = `\n            <div class=\"info\"><span>Likes</span> ${image.likes}</div>\n            <div class=\"info\"><span>Views</span> ${image.views}</div>\n            <div class=\"info\"><span>Comments</span> ${image.comments}</div>\n            <div class=\"info\"><span>Downloads</span> ${image.downloads}</div>\n        `;\n\n        a.appendChild(img);\n        li.appendChild(a);\n        li.appendChild(underDiv);\n\n        return li;\n    });\n\n    items.forEach(item => gallery.appendChild(item));\n\n    // Initialize SimpleLightbox\n    const lightbox = new SimpleLightbox('.gallery a', {\n        captionType: 'attr',\n        captionsData: 'alt',\n        captionDelay: 250\n    });\n\n    if (items.length > 0) {\n        showLoadMoreButton();\n    }\n}\n\nfunction showLoadMoreButton() {\n    const loadMoreButton = document.getElementById('load-more');\n    loadMoreButton.classList.remove('hidden');\n}\n\nfunction hideLoadMoreButton() {\n    const loadMoreButton = document.getElementById('load-more');\n    loadMoreButton.classList.add('hidden');\n}\nfunction scrollPage() {\n    \n    const galleryItems = document.querySelectorAll('.gallery-item');\n    if (galleryItems.length > 0) {\n        const firstItemHeight = galleryItems[0].getBoundingClientRect().height;\n     \n        window.scrollBy({\n            top: 2 * firstItemHeight,\n            behavior: 'smooth'\n        });\n    }\n}"],"names":["page","perPage","currentQuery","totalHits","totalPages","event","query","hideLoadMoreButton","fetchImages","loader","loadMoreButton","url","response","axios","iziToast","displayImages","showLoadMoreButton","scrollPage","error","images","gallery","items","image","li","a","img","underDiv","item","SimpleLightbox","galleryItems","firstItemHeight"],"mappings":"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"}